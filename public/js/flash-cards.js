!function(){function e(e,t,n,a){a.setDefaults({className:"ngdialog-theme-default",showClose:!0,closeByDocument:!0,closeByEscape:!0,width:"75%",height:"40%"}),n.includeSpinner=!0,n.parentSelector="#loadingContainer",n.spinnerTemplate='<div class="center"><img src="/images/loading.svg"></div>',e.when("/",{templateUrl:"cards.html",controller:"CardController"}).when("/login",{controller:"LoginController",templateUrl:"login.html",controllerAs:"vm"}).when("/test",{controller:"FlashCardTestController",templateUrl:"flash-card-test.html"}).when("/index",{templateUrl:"cards.html",controller:"CardController"}).otherwise({redirectTo:"/login"})}function t(e,t){e.globals.currentUser&&(t.defaults.headers.common["x-access-token"]=e.globals.currentUser.authdata)}function n(e,n,a){t(e,a);var o=$.inArray(n.path(),["/login","/register"])===-1,r=e.globals.currentUser;o&&!r&&n.path("/login")}function a(e,a,o,r){e.globals=r.get("flash_card_creds")||{},t(e,o),n(e,a,o),e.$on("$locationChangeStart",function(t,r,i){n(e,a,o)})}angular.module("flashCard",["ngRoute","flashCard.controllers.main","flashCard.controllers.login","flashCard.controllers.cards","flashCard.controllers.cardModal","flashCard.controllers.cardsTest","flashCard.services","angular-loading-bar","ngAnimate","flash","LocalStorageModule","ngDialog","bw.paging","ui.tinymce"]).config(e).run(a),e.$inject=["$routeProvider","$locationProvider","cfpLoadingBarProvider","ngDialogProvider"],a.$inject=["$rootScope","$location","$http","localStorageService"]}(),function(){function e(e,t,n,a,o,r){function i(){a.getCards(e.currentPage,e.pageSize).then(function(t){e.cards=t.data.data.items;for(var n=0;n<e.cards.length;n++)e.cards[n].isFrontShown=!0;e.total=t.data.data.pagination.rowCount}).catch(function(e){o.create("danger",e.data.message,"custom-class")})}e.currentPage=1,e.pageSize=4,e.total=0,e.dialogShown=!1,e.dialogTitle="",e.currentCard={},e.getCards=i,n.$emit("onTabChanged",0),e.reload=function(){i()},e.pageContent=function(t,n,a,o){e.currentPage=n,e.pageSize=a,i()},e.flip=function(e){e.isFrontShown=!e.isFrontShown},e.delete=function(e){a.deleteCard(e.id).then(function(e){i()}).catch(function(e){o.create("danger",e.data.message,"custom-class")})},e.currentDialog={},e.edit=function(t){e.currentCard=t,e.currentCard.type=e.currentCard.type+"",e.currentDialog=r.open({template:"/templates/card.html",controller:"CardModalController",scope:e})},e.add=function(){e.currentCard={type:"1"},e.currentDialog=r.open({template:"/templates/card.html",controller:"CardModalController",scope:e})},e.addOrUpdate=function(){e.currentCard.id?a.updateCard(e.currentCard).then(function(t){e.dialogShown=!1,i()}).catch(function(e){o.create("danger",e.data.message,"custom-class")}):a.insertCard(e.currentCard).then(function(e){i()}).catch(function(e){o.create("danger",e.data.message,"custom-class")})},e.tinymceOptions={plugins:"link image code codesample autoresize",toolbar:"undo redo | bold italic | alignleft aligncenter alignright | codesample"},e.tinymceOptionsReadOnly={plugins:"codesample autoresize",toolbar:"codesample",menubar:!1,readonly:1},i()}angular.module("flashCard.controllers.cards",[]).controller("CardController",["$scope","$location","$rootScope","flashCardService","Flash","ngDialog",e])}(),function(){function e(e,t,n,a,o,r){e.cancel=function(){e.currentDialog.close()};var i=!1;e.currentCard.hints?(e.currentCard.hints=JSON.parse(e.currentCard.hints),0===e.currentCard.hints.length&&(i=!0)):i=!0,i&&(e.currentCard.hints=[{hint:""}]),e.addHint=function(){e.currentCard.hints.push({hint:""})},e.addOrUpdate=function(){e.currentCard.type=Number(e.currentCard.type);var t=[],n=e.currentCard.hints;if(n&&n.length>0)for(var r=0;r<n.length;r++)null!==n[r].hint&&""!==n[r].hint&&t.push(n[r]);e.currentCard.hints=t,e.currentCard.id?a.updateCard(e.currentCard).then(function(t){e.currentDialog.close(),e.getCards()}).catch(function(e){o.create("danger",e.data.message,"card-error")}):a.insertCard(e.currentCard).then(function(t){e.currentDialog.close(),e.getCards()}).catch(function(e){o.create("danger",e.data.message,"card-error")})},e.tinymceOptions={plugins:"link image code codesample autoresize",toolbar:"undo redo | bold italic | alignleft aligncenter alignright | codesample"}}angular.module("flashCard.controllers.cardModal",[]).controller("CardModalController",["$scope","$location","$rootScope","flashCardService","Flash","ngDialog",e])}(),function(){var e=function(e,t,n,a){var o=function(t,n,a){return e.post("/api/v1/authenticate",{username:t,password:n})},r=function(e){a.remove("flash_card_creds"),n.globals={},e()},i=function(e,t){n.globals={currentUser:{username:e,authdata:t}},a.set("flash_card_creds",{currentUser:{username:e,authdata:t}})},l=function(t,n){return e.get("/api/v1/cards",{params:{currentPage:t,pageSize:n}})},c=function(t){return e.put("/api/v1/cards/"+t.id,t)},s=function(t){return e.post("/api/v1/cards",t)},d=function(t){return e.delete("/api/v1/cards/"+t)},u=function(t,n){return e.get("/api/v1/cards/random")};return{login:o,logout:r,setCredentials:i,getCards:l,deleteCard:d,updateCard:c,insertCard:s,getRandom:u}};angular.module("flashCard.services",[]).factory("flashCardService",["$http","$location","$rootScope","localStorageService",e])}(),function(){function e(e,t,n,a,o){function r(){e.currentHint=null,e.currentHintIndex=0,a.getRandom().then(function(t){e.card=t.data.data,e.card.isFrontShown=!0,e.card.hints&&(e.card.hints=JSON.parse(e.card.hints)),e.areHintsAvailable=e.card.hints&&e.card.hints.length>0}).catch(function(e){o.create("danger",e.data.message,"custom-class")})}n.$emit("onTabChanged",1),e.card={isFrontShown:!0},e.flip=function(e){e.isFrontShown=!e.isFrontShown},e.refresh=function(){r()},e.currentHintIndex=0,e.showHints=function(){var t=e.card.hints;t.length>e.currentHintIndex?(e.currentHint=t[e.currentHintIndex].hint,e.currentHintIndex++):e.currentHint="No more hints are available"},e.areHintsAvailable=!1,e.tinymceOptionsReadOnly={plugins:"codesample autoresize",toolbar:"codesample",menubar:!1,readonly:1},r()}angular.module("flashCard.controllers.cardsTest",[]).controller("FlashCardTestController",["$scope","$location","$rootScope","flashCardService","Flash",e])}(),function(){function e(e,t,n){function a(){o.dataLoading=!0,t.login(o.username,o.password).then(function(n){t.setCredentials(o.username,o.password),o.dataLoading=!1,e.path("/index")}).catch(function(e){n.create("danger",e.data.message,"custom-class"),o.dataLoading=!1})}var o=this;o.login=a}angular.module("flashCard.controllers.login",[]).controller("LoginController",["$location","flashCardService","Flash",e])}(),function(){var e=function(e,t,n,a,o){e.selectedTab=-1,e.isLoggedIn=!1,t.$on("onTabChanged",function(t,n){console.log(n),e.isLoggedIn=!0,e.selectedTab=n}),e.logout=function(){e.selectedTab=-1,e.isLoggedIn=!1,n.logout(function(){a.path("/login")})},e.reloadServer=function(){n.flushCache().then(function(e){o.create("info",e.data.data.message,"custom-class")}).catch(function(e){o.create("danger",e.message,"custom-class")})}};angular.module("flashCard.controllers.main",[]).controller("MainController",["$scope","$rootScope","flashCardService","$location","Flash",e])}(),!function(){"use strict";var e=angular.module("flash",[]);e.run(["$rootScope",function(e){e.flash={},e.flash.text="",e.flash.type="",e.flash.timeout=5e3,e.hasFlash=!1}]),e.directive("dynamic",["$compile",function(e){return{restrict:"A",replace:!0,link:function(t,n,a){t.$watch(a.dynamic,function(a){n.html(a),e(n.contents())(t)})}}}]),e.directive("closeFlash",["$compile","Flash",function(e,t){return{link:function(e,n){n.on("click",function(){t.dismiss()})}}}]),e.directive("flashMessage",["$compile","$rootScope",function(e,t){return{restrict:"A",template:'<div role="alert" ng-show="hasFlash" class="alert {{flash.addClass}} alert-{{flash.type}} alert-dismissible ng-hide alertIn alertOut "> <span dynamic="flash.text"></span> <button type="button" class="close" close-flash><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button> </div>',link:function(e,n,a){t.flash.timeout=parseInt(a.flashMessage,10)}}}]),e.factory("Flash",["$rootScope","$timeout",function(e,t){var n,a={};return a.create=function(a,o,r){var i=this;t.cancel(n),e.flash.type=a,e.flash.text=o,e.flash.addClass=r,t(function(){e.hasFlash=!0},100),n=t(function(){i.dismiss()},e.flash.timeout)},a.pause=function(){t.cancel(n)},a.dismiss=function(){t.cancel(n),t(function(){e.hasFlash=!1})},a}])}(),!function(e,t){"use strict";var n=t.isDefined,a=t.isUndefined,o=t.isNumber,r=t.isObject,i=t.isArray,l=t.extend,c=t.toJson,s=t.module("LocalStorageModule",[]);s.provider("localStorageService",function(){this.prefix="ls",this.storageType="localStorage",this.cookie={expiry:30,path:"/"},this.notify={setItem:!0,removeItem:!1},this.setPrefix=function(e){return this.prefix=e,this},this.setStorageType=function(e){return this.storageType=e,this},this.setStorageCookie=function(e,t){return this.cookie.expiry=e,this.cookie.path=t,this},this.setStorageCookieDomain=function(e){return this.cookie.domain=e,this},this.setNotify=function(e,t){return this.notify={setItem:e,removeItem:t},this},this.$get=["$rootScope","$window","$document","$parse",function(e,t,s,d){var u,g=this,f=g.prefix,m=g.cookie,h=g.notify,p=g.storageType;s?s[0]&&(s=s[0]):s=document,"."!==f.substr(-1)&&(f=f?f+".":"");var v=function(e){return f+e},y=function(){try{var n=p in t&&null!==t[p],a=v("__"+Math.round(1e7*Math.random()));return n&&(u=t[p],u.setItem(a,""),u.removeItem(a)),n}catch(t){return p="cookie",e.$broadcast("LocalStorageModule.notification.error",t.message),!1}}(),b=function(t,n){if(n=a(n)?null:c(n),!y||"cookie"===g.storageType)return y||e.$broadcast("LocalStorageModule.notification.warning","LOCAL_STORAGE_NOT_SUPPORTED"),h.setItem&&e.$broadcast("LocalStorageModule.notification.setitem",{key:t,newvalue:n,storageType:"cookie"}),T(t,n);try{u&&u.setItem(v(t),n),h.setItem&&e.$broadcast("LocalStorageModule.notification.setitem",{key:t,newvalue:n,storageType:g.storageType})}catch(a){return e.$broadcast("LocalStorageModule.notification.error",a.message),T(t,n)}return!0},C=function(t){if(!y||"cookie"===g.storageType)return y||e.$broadcast("LocalStorageModule.notification.warning","LOCAL_STORAGE_NOT_SUPPORTED"),A(t);var n=u?u.getItem(v(t)):null;if(!n||"null"===n)return null;try{return JSON.parse(n)}catch(e){return n}},$=function(){var t,n;for(t=0;t<arguments.length;t++)if(n=arguments[t],y&&"cookie"!==g.storageType)try{u.removeItem(v(n)),h.removeItem&&e.$broadcast("LocalStorageModule.notification.removeitem",{key:n,storageType:g.storageType})}catch(t){e.$broadcast("LocalStorageModule.notification.error",t.message),k(n)}else y||e.$broadcast("LocalStorageModule.notification.warning","LOCAL_STORAGE_NOT_SUPPORTED"),h.removeItem&&e.$broadcast("LocalStorageModule.notification.removeitem",{key:n,storageType:"cookie"}),k(n)},D=function(){if(!y)return e.$broadcast("LocalStorageModule.notification.warning","LOCAL_STORAGE_NOT_SUPPORTED"),!1;var t=f.length,n=[];for(var a in u)if(a.substr(0,t)===f)try{n.push(a.substr(t))}catch(t){return e.$broadcast("LocalStorageModule.notification.error",t.Description),[]}return n},S=function(t){var n=f?new RegExp("^"+f):new RegExp,a=t?new RegExp(t):new RegExp;if(!y||"cookie"===g.storageType)return y||e.$broadcast("LocalStorageModule.notification.warning","LOCAL_STORAGE_NOT_SUPPORTED"),O();var o=f.length;for(var r in u)if(n.test(r)&&a.test(r.substr(o)))try{$(r.substr(o))}catch(t){return e.$broadcast("LocalStorageModule.notification.error",t.message),O()}return!0},w=function(){try{return t.navigator.cookieEnabled||"cookie"in s&&(s.cookie.length>0||(s.cookie="test").indexOf.call(s.cookie,"test")>-1)}catch(t){return e.$broadcast("LocalStorageModule.notification.error",t.message),!1}}(),T=function(t,n,l){if(a(n))return!1;if((i(n)||r(n))&&(n=c(n)),!w)return e.$broadcast("LocalStorageModule.notification.error","COOKIES_NOT_SUPPORTED"),!1;try{var d="",u=new Date,g="";if(null===n?(u.setTime(u.getTime()+-864e5),d="; expires="+u.toGMTString(),n=""):o(l)&&0!==l?(u.setTime(u.getTime()+24*l*60*60*1e3),d="; expires="+u.toGMTString()):0!==m.expiry&&(u.setTime(u.getTime()+24*m.expiry*60*60*1e3),d="; expires="+u.toGMTString()),t){var f="; path="+m.path;m.domain&&(g="; domain="+m.domain),s.cookie=v(t)+"="+encodeURIComponent(n)+d+f+g}}catch(t){return e.$broadcast("LocalStorageModule.notification.error",t.message),!1}return!0},A=function(t){if(!w)return e.$broadcast("LocalStorageModule.notification.error","COOKIES_NOT_SUPPORTED"),!1;for(var n=s.cookie&&s.cookie.split(";")||[],a=0;a<n.length;a++){for(var o=n[a];" "===o.charAt(0);)o=o.substring(1,o.length);if(0===o.indexOf(v(t)+"=")){var r=decodeURIComponent(o.substring(f.length+t.length+1,o.length));try{return JSON.parse(r)}catch(e){return r}}}return null},k=function(e){T(e,null)},O=function(){for(var e=null,t=f.length,n=s.cookie.split(";"),a=0;a<n.length;a++){for(e=n[a];" "===e.charAt(0);)e=e.substring(1,e.length);var o=e.substring(t,e.indexOf("="));k(o)}},E=function(){return p},L=function(e,t,a,o){o=o||t;var i=C(o);return null===i&&n(a)?i=a:r(i)&&r(a)&&(i=l(a,i)),d(t).assign(e,i),e.$watch(t,function(e){b(o,e)},r(e[t]))},x=function(){for(var e=0,n=t[p],a=0;a<n.length;a++)0===n.key(a).indexOf(f)&&e++;return e};return{isSupported:y,getStorageType:E,set:b,add:b,get:C,keys:D,remove:$,clearAll:S,bind:L,deriveKey:v,length:x,cookie:{isSupported:w,set:T,add:T,get:A,remove:k,clearAll:O}}}]})}(window,window.angular),angular.module("ui.tinymce",[]).value("uiTinymceConfig",{}).directive("uiTinymce",["$rootScope","$compile","$timeout","$window","$sce","uiTinymceConfig","uiTinymceService",function(e,t,n,a,o,r,i){return r=r||{},r.baseUrl&&(tinymce.baseURL=r.baseUrl),{require:["ngModel","^?form"],priority:599,link:function(l,c,s,d){function u(e){e?(g(),m&&m.getBody().setAttribute("contenteditable",!1)):(g(),m&&!m.settings.readonly&&m.getDoc()&&m.getBody().setAttribute("contenteditable",!0))}function g(){m||(m=tinymce.get(s.id))}if(a.tinymce){var f,m,h=d[0],p=d[1]||null,v={debounce:!0},y=function(t){var n=t.getContent({format:v.format}).trim();n=o.trustAsHtml(n),h.$setViewValue(n),e.$$phase||l.$digest()},b=i.getUniqueId();s.$set("id",b),f={},angular.extend(f,l.$eval(s.uiTinymce));var C=function(e){var t;return function(a){n.cancel(t),t=n(function(){return function(e){e.isDirty()&&(e.save(),y(e))}(a)},e)}}(400),$={setup:function(t){t.on("init",function(){h.$render(),h.$setPristine(),h.$setUntouched(),p&&p.$setPristine()}),t.on("ExecCommand change NodeChange ObjectResized",function(){return v.debounce?void C(t):(t.save(),void y(t))}),t.on("blur",function(){c[0].blur(),h.$setTouched(),e.$$phase||l.$digest()}),t.on("remove",function(){c.remove()}),r.setup&&r.setup(t,{updateView:y}),f.setup&&f.setup(t,{updateView:y})},format:f.format||"html",selector:"#"+s.id};angular.extend(v,r,f,$),n(function(){v.baseURL&&(tinymce.baseURL=v.baseURL);var e=tinymce.init(v);e&&"function"==typeof e.then?e.then(function(){u(l.$eval(s.ngDisabled))}):u(l.$eval(s.ngDisabled))}),h.$formatters.unshift(function(e){return e?o.trustAsHtml(e):""}),h.$parsers.unshift(function(e){return e?o.getTrustedHtml(e):""}),h.$render=function(){g();var e=h.$viewValue?o.getTrustedHtml(h.$viewValue):"";m&&m.getDoc()&&(m.setContent(e),m.fire("change"))},s.$observe("disabled",u),l.$on("$tinymce:refresh",function(e,n){var a=s.id;if(angular.isUndefined(n)||n===a){var o=c.parent(),r=c.clone();r.removeAttr("id"),r.removeAttr("style"),r.removeAttr("aria-hidden"),tinymce.execCommand("mceRemoveEditor",!1,a),o.append(t(r)(l))}}),l.$on("$destroy",function(){g(),m&&(m.remove(),m=null)})}}}}]).service("uiTinymceService",[function(){var e=function(){var e="ui-tinymce",t=0,n=function(){return t++,e+"-"+t};return{getUniqueId:n}};return new e}]),!function(e,t){"undefined"!=typeof module&&module.exports?(t("undefined"==typeof angular?require("angular"):angular),module.exports="ngDialog"):"function"==typeof define&&define.amd?define(["angular"],t):t(e.angular)}(this,function(e){"use strict";var t=e.module("ngDialog",[]),n=e.element,a=e.isDefined,o=(document.body||document.documentElement).style,r=a(o.animation)||a(o.WebkitAnimation)||a(o.MozAnimation)||a(o.MsAnimation)||a(o.OAnimation),i="animationend webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend",l="a[href], area[href], input:not([disabled]), select:not([disabled]), textarea:not([disabled]), button:not([disabled]), iframe, object, embed, *[tabindex], *[contenteditable]",c="ngdialog-disabled-animation",s={html:!1,body:!1},d={},u=[],g=!1,f=!1;return t.provider("ngDialog",function(){var t=this.defaults={className:"ngdialog-theme-default",appendClassName:"",disableAnimation:!1,plain:!1,showClose:!0,closeByDocument:!0,closeByEscape:!0,closeByNavigation:!1,appendTo:!1,preCloseCallback:!1,overlay:!0,cache:!0,trapFocus:!0,preserveFocus:!0,ariaAuto:!0,ariaRole:null,ariaLabelledById:null,ariaLabelledBySelector:null,ariaDescribedById:null,ariaDescribedBySelector:null,bodyClassName:"ngdialog-open",width:null,height:null};this.setForceHtmlReload=function(e){s.html=e||!1},this.setForceBodyReload=function(e){s.body=e||!1},this.setDefaults=function(n){e.extend(t,n)},this.setOpenOnePerName=function(e){f=e||!1};var a,o=0,m=0,h={};this.$get=["$document","$templateCache","$compile","$q","$http","$rootScope","$timeout","$window","$controller","$injector",function(p,v,y,b,C,$,D,S,w,T){var A=[],k={onDocumentKeydown:function(e){27===e.keyCode&&O.close("$escape")},activate:function(e){var t=e.data("$ngDialogOptions");t.trapFocus&&(e.on("keydown",k.onTrapFocusKeydown),A.body.on("keydown",k.onTrapFocusKeydown))},deactivate:function(e){e.off("keydown",k.onTrapFocusKeydown),A.body.off("keydown",k.onTrapFocusKeydown)},deactivateAll:function(t){e.forEach(t,function(t){var n=e.element(t);k.deactivate(n)})},setBodyPadding:function(e){var t=parseInt(A.body.css("padding-right")||0,10);A.body.css("padding-right",t+e+"px"),A.body.data("ng-dialog-original-padding",t),$.$broadcast("ngDialog.setPadding",e)},resetBodyPadding:function(){var e=A.body.data("ng-dialog-original-padding");e?A.body.css("padding-right",e+"px"):A.body.css("padding-right",""),$.$broadcast("ngDialog.setPadding",0)},performCloseDialog:function(e,t){var n=e.data("$ngDialogOptions"),o=e.attr("id"),l=d[o];if(l){if("undefined"!=typeof S.Hammer){var c=l.hammerTime;c.off("tap",a),c.destroy&&c.destroy(),delete l.hammerTime}else e.unbind("click");1===m&&A.body.unbind("keydown",k.onDocumentKeydown),e.hasClass("ngdialog-closing")||(m-=1);var s=e.data("$ngDialogPreviousFocus");s&&s.focus&&s.focus(),$.$broadcast("ngDialog.closing",e,t),m=m<0?0:m,r&&!n.disableAnimation?(l.$destroy(),e.unbind(i).bind(i,function(){k.closeDialogElement(e,t)}).addClass("ngdialog-closing")):(l.$destroy(),k.closeDialogElement(e,t)),h[o]&&(h[o].resolve({id:o,value:t,$dialog:e,remainingDialogs:m}),delete h[o]),d[o]&&delete d[o],u.splice(u.indexOf(o),1),u.length||(A.body.unbind("keydown",k.onDocumentKeydown),g=!1)}},closeDialogElement:function(e,t){var n=e.data("$ngDialogOptions");e.remove(),0===m&&(A.html.removeClass(n.bodyClassName),A.body.removeClass(n.bodyClassName),k.resetBodyPadding()),$.$broadcast("ngDialog.closed",e,t)},closeDialog:function(t,n){var a=t.data("$ngDialogPreCloseCallback");if(a&&e.isFunction(a)){var o=a.call(t,n);if(e.isObject(o))o.closePromise?o.closePromise.then(function(){k.performCloseDialog(t,n)},function(){return!1}):o.then(function(){k.performCloseDialog(t,n)},function(){return!1});else{if(o===!1)return!1;k.performCloseDialog(t,n)}}else k.performCloseDialog(t,n)},onTrapFocusKeydown:function(t){var n,a=e.element(t.currentTarget);if(a.hasClass("ngdialog"))n=a;else if(n=k.getActiveDialog(),null===n)return;var o=9===t.keyCode,r=t.shiftKey===!0;o&&k.handleTab(n,t,r)},handleTab:function(e,t,n){var a=k.getFocusableElements(e);if(0===a.length)return void(document.activeElement&&document.activeElement.blur&&document.activeElement.blur());var o=document.activeElement,r=Array.prototype.indexOf.call(a,o),i=r===-1,l=0===r,c=r===a.length-1,s=!1;n?(i||l)&&(a[a.length-1].focus(),s=!0):(i||c)&&(a[0].focus(),s=!0),s&&(t.preventDefault(),t.stopPropagation())},autoFocus:function(e){var t=e[0],a=t.querySelector("*[autofocus]");if(null===a||(a.focus(),document.activeElement!==a)){var o=k.getFocusableElements(e);if(o.length>0)return void o[0].focus();var r=k.filterVisibleElements(t.querySelectorAll("h1,h2,h3,h4,h5,h6,p,span"));if(r.length>0){var i=r[0];n(i).attr("tabindex","-1").css("outline","0"),i.focus()}}},getFocusableElements:function(e){var t=e[0],n=t.querySelectorAll(l),a=k.filterTabbableElements(n);return k.filterVisibleElements(a)},filterTabbableElements:function(e){for(var t=[],a=0;a<e.length;a++){var o=e[a];"-1"!==n(o).attr("tabindex")&&t.push(o)}return t},filterVisibleElements:function(e){for(var t=[],n=0;n<e.length;n++){var a=e[n];(a.offsetWidth>0||a.offsetHeight>0)&&t.push(a)}return t},getActiveDialog:function(){var e=document.querySelectorAll(".ngdialog");return 0===e.length?null:n(e[e.length-1])},applyAriaAttributes:function(e,t){if(t.ariaAuto){if(!t.ariaRole){var n=k.getFocusableElements(e).length>0?"dialog":"alertdialog";t.ariaRole=n}t.ariaLabelledBySelector||(t.ariaLabelledBySelector="h1,h2,h3,h4,h5,h6"),t.ariaDescribedBySelector||(t.ariaDescribedBySelector="article,section,p")}t.ariaRole&&e.attr("role",t.ariaRole),k.applyAriaAttribute(e,"aria-labelledby",t.ariaLabelledById,t.ariaLabelledBySelector),k.applyAriaAttribute(e,"aria-describedby",t.ariaDescribedById,t.ariaDescribedBySelector)},applyAriaAttribute:function(e,t,a,o){if(a&&e.attr(t,a),o){var r=e.attr("id"),i=e[0].querySelector(o);if(!i)return;var l=r+"-"+t;return n(i).attr("id",l),e.attr(t,l),l}},detectUIRouter:function(){try{return e.module("ui.router"),!0}catch(e){return!1}},getRouterLocationEventName:function(){return k.detectUIRouter()?"$stateChangeStart":"$locationChangeStart"}},O={__PRIVATE__:k,open:function(r){function i(e,t){return $.$broadcast("ngDialog.templateLoading",e),C.get(e,t||{}).then(function(t){return $.$broadcast("ngDialog.templateLoaded",e),t.data||""})}function l(t){return t?e.isString(t)&&p.plain?t:"boolean"!=typeof p.cache||p.cache?i(t,{cache:v}):i(t,{cache:!1}):"Empty template"}var s=null;if(r=r||{},!(f&&r.name&&(s=r.name.toLowerCase().replace(/\s/g,"-")+"-dialog",this.isOpen(s)))){var p=e.copy(t),E=++o;s=s||"ngdialog"+E,u.push(s),"undefined"!=typeof p.data&&("undefined"==typeof r.data&&(r.data={}),r.data=e.merge(e.copy(p.data),r.data)),e.extend(p,r);var L;h[s]=L=b.defer();var x;d[s]=x=e.isObject(p.scope)?p.scope.$new():$.$new();var F,I,P,B=e.extend({},p.resolve);return e.forEach(B,function(t,n){B[n]=e.isString(t)?T.get(t):T.invoke(t,null,null,n)}),b.all({template:l(p.template||p.templateUrl),locals:b.all(B)}).then(function(t){var o=t.template,r=t.locals;p.showClose&&(o+='<div class="ngdialog-close"></div>');var i=p.overlay?"":" ngdialog-no-overlay";if(F=n('<div id="'+s+'" class="ngdialog'+i+'"></div>'),F.html(p.overlay?'<div class="ngdialog-overlay"></div><div class="ngdialog-content" role="document">'+o+"</div>":'<div class="ngdialog-content" role="document">'+o+"</div>"),F.data("$ngDialogOptions",p),x.ngDialogId=s,p.data&&e.isString(p.data)){var l=p.data.replace(/^\s*/,"")[0];x.ngDialogData="{"===l||"["===l?e.fromJson(p.data):new String(p.data),x.ngDialogData.ngDialogId=s}else p.data&&e.isObject(p.data)&&(x.ngDialogData=p.data,x.ngDialogData.ngDialogId=s);if(p.className&&F.addClass(p.className),p.appendClassName&&F.addClass(p.appendClassName),p.width&&(P=F[0].querySelector(".ngdialog-content"),e.isString(p.width)?P.style.width=p.width:P.style.width=p.width+"px"),p.height&&(P=F[0].querySelector(".ngdialog-content"),e.isString(p.height)?P.style.height=p.height:P.style.height=p.height+"px"),p.disableAnimation&&F.addClass(c),I=p.appendTo&&e.isString(p.appendTo)?e.element(document.querySelector(p.appendTo)):A.body,k.applyAriaAttributes(F,p),p.preCloseCallback){var d;e.isFunction(p.preCloseCallback)?d=p.preCloseCallback:e.isString(p.preCloseCallback)&&x&&(e.isFunction(x[p.preCloseCallback])?d=x[p.preCloseCallback]:x.$parent&&e.isFunction(x.$parent[p.preCloseCallback])?d=x.$parent[p.preCloseCallback]:$&&e.isFunction($[p.preCloseCallback])&&(d=$[p.preCloseCallback])),d&&F.data("$ngDialogPreCloseCallback",d)}if(x.closeThisDialog=function(e){k.closeDialog(F,e)},p.controller&&(e.isString(p.controller)||e.isArray(p.controller)||e.isFunction(p.controller))){var u;p.controllerAs&&e.isString(p.controllerAs)&&(u=p.controllerAs);var f=w(p.controller,e.extend(r,{$scope:x,$element:F}),!0,u);p.bindToController&&e.extend(f.instance,{ngDialogId:x.ngDialogId,ngDialogData:x.ngDialogData,closeThisDialog:x.closeThisDialog,confirm:x.confirm}),"function"==typeof f?F.data("$ngDialogControllerController",f()):F.data("$ngDialogControllerController",f)}if(D(function(){var e=document.querySelectorAll(".ngdialog");k.deactivateAll(e),y(F)(x);var t=S.innerWidth-A.body.prop("clientWidth");A.html.addClass(p.bodyClassName),A.body.addClass(p.bodyClassName);var n=t-(S.innerWidth-A.body.prop("clientWidth"));n>0&&k.setBodyPadding(n),I.append(F),k.activate(F),p.trapFocus&&k.autoFocus(F),p.name?$.$broadcast("ngDialog.opened",{dialog:F,name:p.name}):$.$broadcast("ngDialog.opened",F)}),g||(A.body.bind("keydown",k.onDocumentKeydown),g=!0),p.closeByNavigation){var h=k.getRouterLocationEventName();$.$on(h,function(e){k.closeDialog(F)===!1&&e.preventDefault()})}if(p.preserveFocus&&F.data("$ngDialogPreviousFocus",document.activeElement),a=function(e){var t=!!p.closeByDocument&&n(e.target).hasClass("ngdialog-overlay"),a=n(e.target).hasClass("ngdialog-close");(t||a)&&O.close(F.attr("id"),a?"$closeButton":"$document")},"undefined"!=typeof S.Hammer){var v=x.hammerTime=S.Hammer(F[0]);v.on("tap",a)}else F.bind("click",a);return m+=1,O}),{id:s,closePromise:L.promise,close:function(e){k.closeDialog(F,e)}}}},openConfirm:function(a){var o=b.defer(),r=e.copy(t);a=a||{},"undefined"!=typeof r.data&&("undefined"==typeof a.data&&(a.data={}),a.data=e.merge(e.copy(r.data),a.data)),e.extend(r,a),r.scope=e.isObject(r.scope)?r.scope.$new():$.$new(),r.scope.confirm=function(e){o.resolve(e);var t=n(document.getElementById(i.id));k.performCloseDialog(t,e)};var i=O.open(r);if(i)return i.closePromise.then(function(e){return e?o.reject(e.value):o.reject()}),o.promise},isOpen:function(e){var t=n(document.getElementById(e));return t.length>0},close:function(e,t){var a=n(document.getElementById(e));if(a.length)k.closeDialog(a,t);else if("$escape"===e){var o=u[u.length-1];a=n(document.getElementById(o)),a.data("$ngDialogOptions").closeByEscape&&k.closeDialog(a,"$escape")}else O.closeAll(t);return O},closeAll:function(e){for(var t=document.querySelectorAll(".ngdialog"),a=t.length-1;a>=0;a--){var o=t[a];k.closeDialog(n(o),e)}},getOpenDialogs:function(){return u},getDefaults:function(){return t}};return e.forEach(["html","body"],function(e){if(A[e]=p.find(e),s[e]){var t=k.getRouterLocationEventName();$.$on(t,function(){A[e]=p.find(e)})}}),O}]}),t.directive("ngDialog",["ngDialog",function(t){return{restrict:"A",scope:{ngDialogScope:"="},link:function(n,a,o){a.on("click",function(a){a.preventDefault();var r=e.isDefined(n.ngDialogScope)?n.ngDialogScope:"noScope";e.isDefined(o.ngDialogClosePrevious)&&t.close(o.ngDialogClosePrevious);var i=t.getDefaults();t.open({template:o.ngDialog,className:o.ngDialogClass||i.className,appendClassName:o.ngDialogAppendClass,controller:o.ngDialogController,controllerAs:o.ngDialogControllerAs,bindToController:o.ngDialogBindToController,scope:r,data:o.ngDialogData,showClose:"false"!==o.ngDialogShowClose&&("true"===o.ngDialogShowClose||i.showClose),closeByDocument:"false"!==o.ngDialogCloseByDocument&&("true"===o.ngDialogCloseByDocument||i.closeByDocument),closeByEscape:"false"!==o.ngDialogCloseByEscape&&("true"===o.ngDialogCloseByEscape||i.closeByEscape),overlay:"false"!==o.ngDialogOverlay&&("true"===o.ngDialogOverlay||i.overlay),preCloseCallback:o.ngDialogPreCloseCallback||i.preCloseCallback,bodyClassName:o.ngDialogBodyClass||i.bodyClassName})})}}}]),t});